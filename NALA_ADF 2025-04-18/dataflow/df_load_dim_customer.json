{
	"name": "df_load_dim_customer",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_parquet",
						"type": "DatasetReference"
					},
					"name": "SrcCusttable"
				},
				{
					"dataset": {
						"referenceName": "ds_excel",
						"type": "DatasetReference"
					},
					"name": "ReportDealerExclusionSegment"
				},
				{
					"dataset": {
						"referenceName": "ds_excel",
						"type": "DatasetReference"
					},
					"name": "ReportDealerExclusionSubSegment"
				},
				{
					"dataset": {
						"referenceName": "ds_snowflake",
						"type": "DatasetReference"
					},
					"name": "LkpTruckVolume"
				},
				{
					"dataset": {
						"referenceName": "ds_snowflake",
						"type": "DatasetReference"
					},
					"name": "SrcCusttableExt"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_snowflake",
						"type": "DatasetReference"
					},
					"name": "CusttableExt"
				},
				{
					"dataset": {
						"referenceName": "ds_snowflake",
						"type": "DatasetReference"
					},
					"name": "Custtable"
				}
			],
			"transformations": [
				{
					"name": "JoinSegmentColumn"
				},
				{
					"name": "JoinSubSegmentColumn"
				},
				{
					"name": "JoinLkpTruckVolumnColumns"
				},
				{
					"name": "JoinCusttableExtColumn"
				},
				{
					"name": "RederiveColumns"
				},
				{
					"name": "ActiveFlag"
				},
				{
					"name": "PullDistinctEntries"
				},
				{
					"name": "UpsertCusttableExtData"
				},
				{
					"name": "InsertCusttableData"
				}
			],
			"scriptLines": [
				"parameters{",
				"     df_prev_max_timestamp as string,",
				"     df_last_mod_tmstmp_repodealexc as string",
				"}",
				"source(output(",
				"          DATAAREAID as string,",
				"          ACCOUNTNUM as string,",
				"          PARTY as long,",
				"          EBCCOMPANYID as string,",
				"          OURACCOUNTNUM as string,",
				"          INVOICEACCOUNT as string,",
				"          CURRENCY as string,",
				"          USECASHDISC as integer,",
				"          MAINCONTACTWORKER as long,",
				"          BLOCKED as integer,",
				"          PASTDUECHECK as integer,",
				"          CREDITMAX as decimal(32,16),",
				"          MANDATORYCREDITLIMIT as integer,",
				"          EXCLUDECREDITLIMITBLOCKING as integer,",
				"          GRACEDAYS as decimal(32,16),",
				"          EBCBUYGRPEXEMPTION as integer,",
				"          EBCBUYGRPKICKER as integer,",
				"          CASHDISC as string,",
				"          DLVMODE as string,",
				"          DLVTERM as string,",
				"          PAYMMODE as string,",
				"          PAYMTERMID as string,",
				"          CUSTCLASSIFICATIONID as string,",
				"          COMPANYCHAINID as string,",
				"          CUSTGROUP as string,",
				"          EBCDIVISIONID as string,",
				"          LINEOFBUSINESSID as string,",
				"          MARKUPGROUP as string,",
				"          PRICEGROUP as string,",
				"          DEFAULTDIMENSION as long,",
				"          SALESDISTRICTID as string,",
				"          SALESGROUP as string,",
				"          SALESPOOLID as string,",
				"          SEGMENTID as string,",
				"          SUBSEGMENTID as string,",
				"          TAXGROUP as string,",
				"          EBCREPORTPARENT as string,",
				"          MCSEXTERNALPRICING as integer,",
				"          MCSNETWORKID as string,",
				"          MODIFIEDDATETIME as timestamp,",
				"          DIRPARTYTABLE1_NAME as string,",
				"          DIRPARTYTABLE1_INSTANCERELATIONTYPE as long,",
				"          DIRPARTYTABLE1_EBCLEGACY as string,",
				"          DIRPARTYTABLE1_ORGNUMBER as string,",
				"          DIRPARTYTABLE1_PRIMARYADDRESSLOCATION as long,",
				"          DIRPARTYTABLE1_MODIFIEDDATETIME as timestamp,",
				"          CURRENCY_TXT as string,",
				"          CURRENCY_MODIFIEDDATETIME as timestamp,",
				"          HCMWORKER1_PERSONNELNUMBER as string,",
				"          HCMWORKER1_PERSON as long,",
				"          HCMWORKER1_MODIFIEDDATETIME as timestamp,",
				"          DIRPARTYTABLE2_NAME as string,",
				"          DIRPARTYTABLE2_MODIFIEDDATETIME as timestamp,",
				"          TSIAVGDAYS_CPAVGDAY as integer,",
				"          TSIAVGDAYS_YRAVGDAY as integer,",
				"          CASHDISC_DESCRIPTION as string,",
				"          CASHDISC_PERCENT as decimal(32,16),",
				"          DLVMODE_TXT as string,",
				"          DLVTERM_TXT as string,",
				"          CUSTPAYMMODETABLE_NAME as string,",
				"          PAYMTERM_DESCRIPTION as string,",
				"          PAYMTERM_NUMOFDAYS as integer,",
				"          PAYMTERM_NUMOFMONTHS as integer,",
				"          CUSTCLASSIFICATIONGROUP_TXT as string,",
				"          SMMBUSRELCHAINGROUP_DESCRIPTION as string,",
				"          CUSTGROUP_NAME as string,",
				"          SMMBUSRELSALESDISTRICTGROUP1_EBCDIVISIONID as string,",
				"          SMMBUSRELSALESDISTRICTGROUP1_DESCRIPTION as string,",
				"          SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP1 as string,",
				"          SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP2 as string,",
				"          SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP3 as string,",
				"          EBCSALESMKTDIVISION1_EBCDIVISIONDESC as string,",
				"          LINEOFBUSINESS_DESCRIPTION as string,",
				"          MARKUPGROUP_TXT as string,",
				"          PRICEDISCGROUP_NAME as string,",
				"          DEFAULTDIMENSION_C_SALES_CHANNEL as string,",
				"          DEFAULTDIMENSION_C_SALES_CHANNEL_DESCRIPTION as string,",
				"          DEFAULTDIMENSION_MODIFIEDDATETIME as timestamp,",
				"          COMMISSIONSALESGROUP_NAME as string,",
				"          SALESPOOL_NAME as string,",
				"          SMMBUSRELSEGMENTGROUP_DESCRIPTION as string,",
				"          SMMBUSRELSUBSEGMENTGROUP_DESCRIPTION as string,",
				"          TAXGROUPHEADING_TAXGROUPNAME as string,",
				"          LOGISTICSPOSTALADDRESS1_STREET as string,",
				"          LOGISTICSPOSTALADDRESS1_CITY as string,",
				"          LOGISTICSPOSTALADDRESS1_STATE as string,",
				"          LOGISTICSPOSTALADDRESS1_ZIPCODE as string,",
				"          LOGISTICSPOSTALADDRESS1_COUNTRYREGIONID as string,",
				"          LOGISTICSPOSTALADDRESS1_TIMEZONE as integer,",
				"          TIMEZONESLIST_TIMEZONEKEYNAME as string,",
				"          LOGISTICSLOCATION1_DESCRIPTION as string,",
				"          LOGISTICSELECTRONICADDRESS1_LOCATOR as string,",
				"          LOGISTICSELECTRONICADDRESS2_LOCATOR as string,",
				"          LOGISTICSELECTRONICADDRESS3_LOCATOR as string,",
				"          LOGISTICSPOSTALADDRESS2_STREET as string,",
				"          LOGISTICSPOSTALADDRESS2_CITY as string,",
				"          LOGISTICSPOSTALADDRESS2_STATE as string,",
				"          LOGISTICSPOSTALADDRESS2_ZIPCODE as string,",
				"          LOGISTICSPOSTALADDRESS2_COUNTRYREGIONID as string,",
				"          LOGISTICSLOCATION2_DESCRIPTION as string,",
				"          LOGISTICSLOCATION2_LOCATIONID as string,",
				"          CUSTTABLE2_EBCDIVISIONID as string,",
				"          CUSTTABLE2_SALESDISTRICTID as string,",
				"          CUSTTABLE2_MAINCONTACTWORKER as long,",
				"          CUSTTABLE2_MODIFIEDDATETIME as timestamp,",
				"          SMMBUSRELSALESDISTRICTGROUP2_DESCRIPTION as string,",
				"          EBCSALESMKTDIVISION2_EBCDIVISIONDESC as string,",
				"          HCMWORKER2_PERSONNELNUMBER as string,",
				"          HCMWORKER2_PERSON as long,",
				"          HCMWORKER2_MODIFIEDDATETIME as timestamp,",
				"          DIRPARTYTABLE3_NAME as string,",
				"          DIRPARTYTABLE3_MODIFIEDDATETIME as timestamp,",
				"          LATEST_MODIFIEDDATETIME as timestamp,",
				"          HK_JOB_RUN_ID as string,",
				"          HK_SOURCE_NAME as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'parquet') ~> SrcCusttable",
				"source(output(",
				"          SegmentID as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> ReportDealerExclusionSegment",
				"source(output(",
				"          SubSegmentID as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> ReportDealerExclusionSubSegment",
				"source(output(",
				"          LKP_TRUCK_VOLUME_LEGAL_ENTITY_ID as string,",
				"          HK_LAST_UPDATED_TIMESTAMP as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     query: 'select ltv1.legal_entity_id as LKP_TRUCK_VOLUME_LEGAL_ENTITY_ID , ltv1.hk_last_updated_timestamp as HK_LAST_UPDATED_TIMESTAMP\\nfrom LKP_TRUCK_VOLUME ltv1\\nwhere is_tempurpedic = true',",
				"     format: 'query') ~> LkpTruckVolume",
				"source(output(",
				"          DATAAREAID as string,",
				"          ACCOUNTNUM as string,",
				"          HK_CUSTTABLE_EXT_HASH_KEY as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     query: 'select DATAAREAID, ACCOUNTNUM, HK_CUSTTABLE_EXT_HASH_KEY from custtable_ext',",
				"     format: 'query') ~> SrcCusttableExt",
				"SrcCusttable, ReportDealerExclusionSegment join(SrcCusttable@SEGMENTID == ReportDealerExclusionSegment@SegmentID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinSegmentColumn",
				"JoinSegmentColumn, ReportDealerExclusionSubSegment join(SrcCusttable@SUBSEGMENTID == ReportDealerExclusionSubSegment@SubSegmentID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinSubSegmentColumn",
				"JoinSubSegmentColumn, LkpTruckVolume join(DATAAREAID == LKP_TRUCK_VOLUME_LEGAL_ENTITY_ID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinLkpTruckVolumnColumns",
				"JoinLkpTruckVolumnColumns, SrcCusttableExt join(SrcCusttable@DATAAREAID == SrcCusttableExt@DATAAREAID",
				"     && SrcCusttable@ACCOUNTNUM == SrcCusttableExt@ACCOUNTNUM,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinCusttableExtColumn",
				"JoinCusttableExtColumn derive(LATEST_MODIFIEDDATETIME_NEW = greatest(LATEST_MODIFIEDDATETIME,\r",
				"iifNull(HK_LAST_UPDATED_TIMESTAMP,toTimestamp('1950-01-01 00:00:00'),HK_LAST_UPDATED_TIMESTAMP),\r",
				"toTimestamp($df_last_mod_tmstmp_repodealexc, 'YYYY-MM-DD HH:MM:SS')),",
				"          SRC_HK_CUSTTABLE_EXT_HASH_KEY = toString(sha1(iif(isNull(SrcCusttable@DATAAREAID),'',SrcCusttable@DATAAREAID),'~',\r",
				"iif(isNull(SrcCusttable@ACCOUNTNUM),'',SrcCusttable@ACCOUNTNUM),'~',\r",
				"iif(isNull(TSIAVGDAYS_CPAVGDAY),0,TSIAVGDAYS_CPAVGDAY),'~',\r",
				"iif(isNull(TSIAVGDAYS_YRAVGDAY),0,TSIAVGDAYS_YRAVGDAY),'~',\r",
				"iif(isNull(CASHDISC_DESCRIPTION),'',CASHDISC_DESCRIPTION),'~',\r",
				"iifNull(CASHDISC_PERCENT, 0 , CASHDISC_PERCENT),'~',\r",
				"iif(isNull(DLVMODE_TXT),'',DLVMODE_TXT),'~',\r",
				"iif(isNull(DLVTERM_TXT),'',DLVTERM_TXT),'~',\r",
				"iif(isNull(CUSTPAYMMODETABLE_NAME),'',CUSTPAYMMODETABLE_NAME),'~',\r",
				"iif(isNull(PAYMTERM_DESCRIPTION),'',PAYMTERM_DESCRIPTION),'~',\r",
				"iif(isNull(PAYMTERM_NUMOFDAYS),0,PAYMTERM_NUMOFDAYS),'~',\r",
				"iif(isNull(PAYMTERM_NUMOFMONTHS),0,PAYMTERM_NUMOFMONTHS),'~',\r",
				"iif(isNull(CUSTCLASSIFICATIONGROUP_TXT),'',CUSTCLASSIFICATIONGROUP_TXT),'~',\r",
				"iif(isNull(SMMBUSRELCHAINGROUP_DESCRIPTION),'',SMMBUSRELCHAINGROUP_DESCRIPTION),'~',\r",
				"iif(isNull(CUSTGROUP_NAME),'',CUSTGROUP_NAME),'~',\r",
				"iif(isNull(SMMBUSRELSALESDISTRICTGROUP1_EBCDIVISIONID),'',SMMBUSRELSALESDISTRICTGROUP1_EBCDIVISIONID),'~',\r",
				"iif(isNull(SMMBUSRELSALESDISTRICTGROUP1_DESCRIPTION),'',SMMBUSRELSALESDISTRICTGROUP1_DESCRIPTION),'~',\r",
				"iif(isNull(SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP1),'',SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP1),'~',\r",
				"iif(isNull(SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP2),'',SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP2),'~',\r",
				"iif(isNull(SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP3),'',SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP3),'~',\r",
				"iif(isNull(EBCSALESMKTDIVISION1_EBCDIVISIONDESC),'',EBCSALESMKTDIVISION1_EBCDIVISIONDESC),'~',\r",
				"iif(isNull(LINEOFBUSINESS_DESCRIPTION),'',LINEOFBUSINESS_DESCRIPTION),'~',\r",
				"iif(isNull(MARKUPGROUP_TXT),'',MARKUPGROUP_TXT),'~',\r",
				"iif(isNull(PRICEDISCGROUP_NAME),'',PRICEDISCGROUP_NAME),'~',\r",
				"iif(isNull(SALESPOOL_NAME),'',SALESPOOL_NAME),'~',\r",
				"iif(isNull(SMMBUSRELSEGMENTGROUP_DESCRIPTION),'',SMMBUSRELSEGMENTGROUP_DESCRIPTION),'~',\r",
				"iif(isNull(SMMBUSRELSUBSEGMENTGROUP_DESCRIPTION),'',SMMBUSRELSUBSEGMENTGROUP_DESCRIPTION),'~',\r",
				"iif(isNull(TAXGROUPHEADING_TAXGROUPNAME),'',TAXGROUPHEADING_TAXGROUPNAME),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS1_STREET),'',LOGISTICSPOSTALADDRESS1_STREET),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS1_CITY),'',LOGISTICSPOSTALADDRESS1_CITY),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS1_STATE),'',LOGISTICSPOSTALADDRESS1_STATE),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS1_ZIPCODE),'',LOGISTICSPOSTALADDRESS1_ZIPCODE),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS1_COUNTRYREGIONID),'',LOGISTICSPOSTALADDRESS1_COUNTRYREGIONID),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS1_TIMEZONE),0,LOGISTICSPOSTALADDRESS1_TIMEZONE),'~',\r",
				"iif(isNull(TIMEZONESLIST_TIMEZONEKEYNAME),'',TIMEZONESLIST_TIMEZONEKEYNAME),'~',\r",
				"iif(isNull(LOGISTICSLOCATION1_DESCRIPTION),'',LOGISTICSLOCATION1_DESCRIPTION),'~',\r",
				"iif(isNull(LOGISTICSELECTRONICADDRESS1_LOCATOR),'',LOGISTICSELECTRONICADDRESS1_LOCATOR),'~',\r",
				"iif(isNull(LOGISTICSELECTRONICADDRESS2_LOCATOR),'',LOGISTICSELECTRONICADDRESS2_LOCATOR),'~',\r",
				"iif(isNull(LOGISTICSELECTRONICADDRESS3_LOCATOR),'',LOGISTICSELECTRONICADDRESS3_LOCATOR),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS2_STREET),'',LOGISTICSPOSTALADDRESS2_STREET),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS2_CITY),'',LOGISTICSPOSTALADDRESS2_CITY),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS2_STATE),'',LOGISTICSPOSTALADDRESS2_STATE),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS2_ZIPCODE),'',LOGISTICSPOSTALADDRESS2_ZIPCODE),'~',\r",
				"iif(isNull(LOGISTICSPOSTALADDRESS2_COUNTRYREGIONID),'',LOGISTICSPOSTALADDRESS2_COUNTRYREGIONID),'~',\r",
				"iif(isNull(LOGISTICSLOCATION2_DESCRIPTION),'',LOGISTICSLOCATION2_DESCRIPTION),'~',\r",
				"iif(isNull(LOGISTICSLOCATION2_LOCATIONID),'',LOGISTICSLOCATION2_LOCATIONID),'~',\r",
				"iif(isNull(SMMBUSRELSALESDISTRICTGROUP2_DESCRIPTION),'',SMMBUSRELSALESDISTRICTGROUP2_DESCRIPTION),'~',\r",
				"iif(isNull(EBCSALESMKTDIVISION2_EBCDIVISIONDESC),'',EBCSALESMKTDIVISION2_EBCDIVISIONDESC),'~',\r",
				"iif(isNull(ReportDealerExclusionSegment@SegmentID),'',ReportDealerExclusionSegment@SegmentID),'~',\r",
				"iif(isNull(ReportDealerExclusionSubSegment@SubSegmentID),'',ReportDealerExclusionSubSegment@SubSegmentID),'~',\r",
				"iif(isNull(LKP_TRUCK_VOLUME_LEGAL_ENTITY_ID),'',LKP_TRUCK_VOLUME_LEGAL_ENTITY_ID),'~'))) ~> RederiveColumns",
				"RederiveColumns derive(ACTIVE_FLAG = iif((SrcCusttable@DATAAREAID == SrcCusttableExt@DATAAREAID && SrcCusttable@ACCOUNTNUM == SrcCusttableExt@ACCOUNTNUM && SRC_HK_CUSTTABLE_EXT_HASH_KEY == HK_CUSTTABLE_EXT_HASH_KEY \r",
				"&& LATEST_MODIFIEDDATETIME_NEW < toTimestamp($df_prev_max_timestamp)) , 'R',\r",
				"iif((SrcCusttable@DATAAREAID == SrcCusttableExt@DATAAREAID && SrcCusttable@ACCOUNTNUM == SrcCusttableExt@ACCOUNTNUM && SRC_HK_CUSTTABLE_EXT_HASH_KEY == HK_CUSTTABLE_EXT_HASH_KEY \r",
				"&& LATEST_MODIFIEDDATETIME_NEW >= toTimestamp($df_prev_max_timestamp)) \r",
				"|| (SrcCusttable@DATAAREAID == SrcCusttableExt@DATAAREAID && SrcCusttable@ACCOUNTNUM == SrcCusttableExt@ACCOUNTNUM && SRC_HK_CUSTTABLE_EXT_HASH_KEY != HK_CUSTTABLE_EXT_HASH_KEY), 'U',\r",
				"'I'))) ~> ActiveFlag",
				"ActiveFlag filter(ACTIVE_FLAG != 'R') ~> PullDistinctEntries",
				"PullDistinctEntries alterRow(updateIf(ACTIVE_FLAG=='U'),",
				"     insertIf(ACTIVE_FLAG=='I')) ~> UpsertCusttableExtData",
				"ActiveFlag filter(ACTIVE_FLAG != 'R') ~> InsertCusttableData",
				"UpsertCusttableExtData sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:true,",
				"     upsertable:false,",
				"     keys:['DATAAREAID','ACCOUNTNUM'],",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     stageInsert: true,",
				"     mapColumn(",
				"          DATAAREAID = SrcCusttable@DATAAREAID,",
				"          ACCOUNTNUM = SrcCusttable@ACCOUNTNUM,",
				"          TSIAVGDAYS_CPAVGDAY,",
				"          TSIAVGDAYS_YRAVGDAY,",
				"          CASHDISC_DESCRIPTION,",
				"          CASHDISC_PERCENT,",
				"          DLVMODE_TXT,",
				"          DLVTERM_TXT,",
				"          CUSTPAYMMODETABLE_NAME,",
				"          PAYMTERM_DESCRIPTION,",
				"          PAYMTERM_NUMOFDAYS,",
				"          PAYMTERM_NUMOFMONTHS,",
				"          CUSTCLASSIFICATIONGROUP_TXT,",
				"          SMMBUSRELCHAINGROUP_DESCRIPTION,",
				"          CUSTGROUP_NAME,",
				"          SMMBUSRELSALESDISTRICTGROUP1_EBCDIVISIONID,",
				"          SMMBUSRELSALESDISTRICTGROUP1_DESCRIPTION,",
				"          SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP1,",
				"          SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP2,",
				"          SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP3,",
				"          EBCSALESMKTDIVISION1_EBCDIVISIONDESC,",
				"          LINEOFBUSINESS_DESCRIPTION,",
				"          MARKUPGROUP_TXT,",
				"          PRICEDISCGROUP_NAME,",
				"          COMMISSIONSALESGROUP_NAME,",
				"          SALESPOOL_NAME,",
				"          SMMBUSRELSEGMENTGROUP_DESCRIPTION,",
				"          SMMBUSRELSUBSEGMENTGROUP_DESCRIPTION,",
				"          TAXGROUPHEADING_TAXGROUPNAME,",
				"          LOGISTICSPOSTALADDRESS1_STREET,",
				"          LOGISTICSPOSTALADDRESS1_CITY,",
				"          LOGISTICSPOSTALADDRESS1_STATE,",
				"          LOGISTICSPOSTALADDRESS1_ZIPCODE,",
				"          LOGISTICSPOSTALADDRESS1_COUNTRYREGIONID,",
				"          LOGISTICSPOSTALADDRESS1_TIMEZONE,",
				"          TIMEZONESLIST_TIMEZONEKEYNAME,",
				"          LOGISTICSLOCATION1_DESCRIPTION,",
				"          LOGISTICSELECTRONICADDRESS1_LOCATOR,",
				"          LOGISTICSELECTRONICADDRESS2_LOCATOR,",
				"          LOGISTICSELECTRONICADDRESS3_LOCATOR,",
				"          LOGISTICSPOSTALADDRESS2_STREET,",
				"          LOGISTICSPOSTALADDRESS2_CITY,",
				"          LOGISTICSPOSTALADDRESS2_STATE,",
				"          LOGISTICSPOSTALADDRESS2_ZIPCODE,",
				"          LOGISTICSPOSTALADDRESS2_COUNTRYREGIONID,",
				"          LOGISTICSLOCATION2_DESCRIPTION,",
				"          LOGISTICSLOCATION2_LOCATIONID,",
				"          SMMBUSRELSALESDISTRICTGROUP2_DESCRIPTION,",
				"          EBCSALESMKTDIVISION2_EBCDIVISIONDESC,",
				"          HK_JOB_RUN_ID,",
				"          HK_SOURCE_NAME,",
				"          REPORTDEALEREXCSEGMENT_SEGMENTID = ReportDealerExclusionSegment@SegmentID,",
				"          REPORTDEALEREXCSUBSEGMENT_SUBSEGMENTID = ReportDealerExclusionSubSegment@SubSegmentID,",
				"          LKP_TRUCK_VOLUME_LEGAL_ENTITY_ID,",
				"          HK_CUSTTABLE_EXT_HASH_KEY = SRC_HK_CUSTTABLE_EXT_HASH_KEY",
				"     )) ~> CusttableExt",
				"InsertCusttableData sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     stageInsert: true,",
				"     mapColumn(",
				"          DATAAREAID = SrcCusttable@DATAAREAID,",
				"          ACCOUNTNUM = SrcCusttable@ACCOUNTNUM,",
				"          PARTY,",
				"          EBCCOMPANYID,",
				"          OURACCOUNTNUM,",
				"          INVOICEACCOUNT,",
				"          CURRENCY,",
				"          USECASHDISC,",
				"          MAINCONTACTWORKER,",
				"          BLOCKED,",
				"          PASTDUECHECK,",
				"          CREDITMAX,",
				"          MANDATORYCREDITLIMIT,",
				"          EXCLUDECREDITLIMITBLOCKING,",
				"          GRACEDAYS,",
				"          EBCBUYGRPEXEMPTION,",
				"          EBCBUYGRPKICKER,",
				"          CASHDISC,",
				"          DLVMODE,",
				"          DLVTERM,",
				"          PAYMMODE,",
				"          PAYMTERMID,",
				"          CUSTCLASSIFICATIONID,",
				"          COMPANYCHAINID,",
				"          CUSTGROUP,",
				"          EBCDIVISIONID,",
				"          LINEOFBUSINESSID,",
				"          MARKUPGROUP,",
				"          PRICEGROUP,",
				"          DEFAULTDIMENSION,",
				"          SALESDISTRICTID,",
				"          SALESGROUP,",
				"          SALESPOOLID,",
				"          SEGMENTID = SrcCusttable@SEGMENTID,",
				"          SUBSEGMENTID = SrcCusttable@SUBSEGMENTID,",
				"          TAXGROUP,",
				"          EBCREPORTPARENT,",
				"          MCSEXTERNALPRICING,",
				"          MCSNETWORKID,",
				"          MODIFIEDDATETIME,",
				"          DIRPARTYTABLE1_NAME,",
				"          DIRPARTYTABLE1_INSTANCERELATIONTYPE,",
				"          DIRPARTYTABLE1_EBCLEGACY,",
				"          DIRPARTYTABLE1_ORGNUMBER,",
				"          DIRPARTYTABLE1_PRIMARYADDRESSLOCATION,",
				"          DIRPARTYTABLE1_MODIFIEDDATETIME,",
				"          CURRENCY_TXT,",
				"          CURRENCY_MODIFIEDDATETIME,",
				"          HCMWORKER1_PERSONNELNUMBER,",
				"          HCMWORKER1_PERSON,",
				"          HCMWORKER1_MODIFIEDDATETIME,",
				"          DIRPARTYTABLE2_NAME,",
				"          DIRPARTYTABLE2_MODIFIEDDATETIME,",
				"          TSIAVGDAYS_CPAVGDAY,",
				"          TSIAVGDAYS_YRAVGDAY,",
				"          CASHDISC_DESCRIPTION,",
				"          CASHDISC_PERCENT,",
				"          DLVMODE_TXT,",
				"          DLVTERM_TXT,",
				"          CUSTPAYMMODETABLE_NAME,",
				"          PAYMTERM_DESCRIPTION,",
				"          PAYMTERM_NUMOFDAYS,",
				"          PAYMTERM_NUMOFMONTHS,",
				"          CUSTCLASSIFICATIONGROUP_TXT,",
				"          SMMBUSRELCHAINGROUP_DESCRIPTION,",
				"          CUSTGROUP_NAME,",
				"          SMMBUSRELSALESDISTRICTGROUP1_EBCDIVISIONID,",
				"          SMMBUSRELSALESDISTRICTGROUP1_DESCRIPTION,",
				"          SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP1,",
				"          SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP2,",
				"          SMMBUSRELSALESDISTRICTGROUP1_ALTROLLUP3,",
				"          EBCSALESMKTDIVISION1_EBCDIVISIONDESC,",
				"          LINEOFBUSINESS_DESCRIPTION,",
				"          MARKUPGROUP_TXT,",
				"          PRICEDISCGROUP_NAME,",
				"          DEFAULTDIMENSION_C_SALES_CHANNEL,",
				"          DEFAULTDIMENSION_C_SALES_CHANNEL_DESCRIPTION,",
				"          DEFAULTDIMENSION_MODIFIEDDATETIME,",
				"          COMMISSIONSALESGROUP_NAME,",
				"          SALESPOOL_NAME,",
				"          SMMBUSRELSEGMENTGROUP_DESCRIPTION,",
				"          SMMBUSRELSUBSEGMENTGROUP_DESCRIPTION,",
				"          TAXGROUPHEADING_TAXGROUPNAME,",
				"          LOGISTICSPOSTALADDRESS1_STREET,",
				"          LOGISTICSPOSTALADDRESS1_CITY,",
				"          LOGISTICSPOSTALADDRESS1_STATE,",
				"          LOGISTICSPOSTALADDRESS1_ZIPCODE,",
				"          LOGISTICSPOSTALADDRESS1_COUNTRYREGIONID,",
				"          LOGISTICSPOSTALADDRESS1_TIMEZONE,",
				"          TIMEZONESLIST_TIMEZONEKEYNAME,",
				"          LOGISTICSLOCATION1_DESCRIPTION,",
				"          LOGISTICSELECTRONICADDRESS1_LOCATOR,",
				"          LOGISTICSELECTRONICADDRESS2_LOCATOR,",
				"          LOGISTICSELECTRONICADDRESS3_LOCATOR,",
				"          LOGISTICSPOSTALADDRESS2_STREET,",
				"          LOGISTICSPOSTALADDRESS2_CITY,",
				"          LOGISTICSPOSTALADDRESS2_STATE,",
				"          LOGISTICSPOSTALADDRESS2_ZIPCODE,",
				"          LOGISTICSPOSTALADDRESS2_COUNTRYREGIONID,",
				"          LOGISTICSLOCATION2_DESCRIPTION,",
				"          LOGISTICSLOCATION2_LOCATIONID,",
				"          CUSTTABLE2_EBCDIVISIONID,",
				"          CUSTTABLE2_SALESDISTRICTID,",
				"          CUSTTABLE2_MAINCONTACTWORKER,",
				"          CUSTTABLE2_MODIFIEDDATETIME,",
				"          SMMBUSRELSALESDISTRICTGROUP2_DESCRIPTION,",
				"          EBCSALESMKTDIVISION2_EBCDIVISIONDESC,",
				"          HCMWORKER2_PERSONNELNUMBER,",
				"          HCMWORKER2_PERSON,",
				"          HCMWORKER2_MODIFIEDDATETIME,",
				"          DIRPARTYTABLE3_NAME,",
				"          DIRPARTYTABLE3_MODIFIEDDATETIME,",
				"          HK_JOB_RUN_ID,",
				"          HK_SOURCE_NAME,",
				"          REPORTDEALEREXCSEGMENT_SEGMENTID = ReportDealerExclusionSegment@SegmentID,",
				"          REPORTDEALEREXCSUBSEGMENT_SUBSEGMENTID = ReportDealerExclusionSubSegment@SubSegmentID,",
				"          LKP_TRUCK_VOLUME_LEGAL_ENTITY_ID,",
				"          LATEST_MODIFIEDDATETIME = LATEST_MODIFIEDDATETIME_NEW",
				"     )) ~> Custtable"
			]
		}
	}
}